// Generated by CoffeeScript 1.6.3
var finder, s3, through;

finder = require('./backup_finder');

through = require('through');

s3 = require('./s3');

module.exports = function(bucket, prefix) {
  var stream;
  stream = through();
  finder.getMostRecentBackup(bucket, prefix, function(err, mostRecent) {
    if (err != null) {
      console.error(err.toString());
      stream.end();
    }
    return s3.getObject({
      Bucket: bucket,
      Key: mostRecent.Key
    }).createReadStream().pipe(stream);
  });
  return stream;
};
